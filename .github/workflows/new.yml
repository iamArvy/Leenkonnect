# name: Deploy via SSH

# on:
#   push:
#     branches:
#       - main  # Replace 'main' with the branch you want to deploy

# jobs:
#   deploy:
#     runs-on: ubuntu-latest

#     steps:
#     - name: Checkout Code
#       uses: actions/checkout@v3

#     - name: Set up SSH
#       run: |
#         mkdir -p ~/.ssh
#         echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
#         chmod 600 ~/.ssh/id_rsa
#         ssh-keyscan -H your-server-ip >> ~/.ssh/known_hosts

#     - name: Deploy Code
#       run: |
#         ssh user@your-server-ip << 'EOF'
#         # Clone the repository or pull the latest changes
#         if [ ! -d "/home/${{vars.SERVER_USERNAME}}/repository" ]; then
#           git clone git@github.com:your-username/your-repo.git /home/${{vars.SERVER_USERNAME}}/repository
#         else
#           cd /home/${{vars.SERVER_USERNAME}}/repository && git pull
#         fi

#         # Navigate to the project directory
#         cd /home/${{vars.SERVER_USERNAME}}/repository

#         # Install dependencies
#         composer install --no-dev --prefer-dist --optimize-autoloader
#         npm install
#         npm run build
#         php artisan storage:link

#         # Copy files to the public_html directory
#         rsync -av --delete ./public/ /home/${{vars.SERVER_USERNAME}}/public_html/

#         # Run Laravel commands
#         php artisan config:cache
#         php artisan route:cache
#         php artisan migrate --force
#         EOF
